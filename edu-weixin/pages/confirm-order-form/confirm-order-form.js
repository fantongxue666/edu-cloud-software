(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/confirm-order-form/confirm-order-form"],{2774:function(t,e,o){"use strict";var a=o("ce38"),i=o.n(a);i.a},"4e8f":function(t,e,o){"use strict";o.r(e);var a=o("8b4e"),i=o("5352");for(var s in i)"default"!==s&&function(t){o.d(e,t,(function(){return i[t]}))}(s);o("2774");var n,d=o("f0c5"),c=Object(d["a"])(i["default"],a["b"],a["c"],!1,null,"03f5bf0f",null,!1,a["a"],n);e["default"]=c.exports},5352:function(t,e,o){"use strict";o.r(e);var a=o("6d9c"),i=o.n(a);for(var s in a)"default"!==s&&function(t){o.d(e,t,(function(){return a[t]}))}(s);e["default"]=i.a},"6d9c":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o("f1e2"),i={data:function(){return{addressinfo:"",courseinfo:[],goodsinfo:[],pxcourse:[],shopcarlist:!1,carlistdata:[],goodstype:"course",total:0,HOST_URL:t.HOST_URL,current:0,paytype:"wxpay",menuid:"",sonid:"",yhm:"",remarks:"",shr_name:"",shr_phone:"",carlistdataid:"",postage:0,items:[{value:"wxpay",name:"微信支付",icon:"../../static/weixinzhifu.png"},{value:"alipay",name:"支付宝支付",icon:"../../static/zhifubao.png"},{value:"balance",name:"余额支付",icon:"../../static/money.png"}],shoppingInfo:"",viptimeinfo:[],czmoney:0,balance:"0.00",action:"",creditinfo:{},userinfo:{},seckillinfo:{},pintuaninfo:{}}},onShareAppMessage:function(e){var o=getCurrentPages(),a=o[0].$page.fullPath,i=(o[0].data.title,t.getStorageSync("userinfo")),s=t.getStorageSync("base_set");return""!=i.uid&&i.uid?(e.from,{title:s.title,path:"".concat(a,"?pid=").concat(i.uid)}):(t.navigateTo({url:"../login/login"}),{title:"请先登录后再分享给好友",path:""})},onLoad:function(e){var o=this;this.goodstype=e.goodstype,this.HOST_URL=t.HOST_URL,e.action&&(this.action=e.action,"credit"==e.action&&(this.items=[{value:"credit",name:"积分兑换",icon:"../../static/credit.png"}],this.paytype="credit")),"mall"==e.goodstype?(this.getmallset(),"1"==e.shopcarlist?(this.shopcarlist=!0,this.shopcardata()):(postDataDetail({id:e.goodsid}).then((function(t){console.log(t.data),o.goodsinfo=t.data.data,o.total=(1*parseFloat(o.goodsinfo.price)+parseFloat(o.postage)).toFixed(2)})),"credit"==e.action?this.get_creditinfo(e.goodsid,e.goodstype):"seckill"==e.action?this.get_seckillinfo(e.goodsid,e.goodstype):"pintuan"==e.action&&this.get_pintuaninfo(e.goodsid,e.goodstype))):"course"==e.goodstype?(e.sonid&&(this.sonid=e.sonid),console.log("sonid "+this.sonid),this.menuid=e.menuid,this.getCourseInfo(e.menuid,e.sonid),"credit"==e.action?this.get_creditinfo(e.menuid,e.goodstype):"seckill"==e.action?this.get_seckillinfo(e.menuid,e.goodstype):"pintuan"==e.action&&this.get_pintuaninfo(e.menuid,e.goodstype)):"pxcourse"==e.goodstype?(this.pxcourseinfo(e.id),"credit"==e.action?this.get_creditinfo(e.id,e.goodstype):"seckill"==e.action?this.get_seckillinfo(e.id,e.goodstype):"pintuan"==e.action&&this.get_pintuaninfo(e.id,e.goodstype)):"vip"==e.goodstype?this.getvipinfo(e.id):"chongzhi"==e.goodstype&&(this.czmoney=e.czmoney,this.total=Number(e.czmoney),this.items.pop())},onUnload:function(){t.removeStorageSync("checked_addressid"),this.menuid="",this.sonid=""},onShow:function(){(0,a.checkUserinfo)();var e=t.getStorageSync("userinfo");if(e){this.balance=e.userdata.money,this.userinfo=e.userdata;var o=t.getStorageSync("checked_addressid");""!=o&&null!=o&&o?this.getaddress(o):this.getaddress("mr")}},methods:{get_creditinfo:function(e,o){var a=this,i=t.BASE_URL;t.request({url:i+"index/credit/creditinfo",data:{id:e,goodstype:o},method:"POST",success:function(t){console.log(t.data),a.creditinfo=t.data.data},fail:function(t){console.log(t.data)}})},get_seckillinfo:function(e,o){var a=this,i=t.BASE_URL;t.request({url:i+"index/seckill/seckillinfo",data:{id:e,goodstype:o},method:"POST",success:function(t){console.log(t.data),a.seckillinfo=t.data.data,a.postage=t.data.data.set.postage,a.total=(1*parseFloat(t.data.data.price)+parseFloat(t.data.data.set.postage)).toFixed(2)},fail:function(t){console.log(t.data)}})},get_pintuaninfo:function(e,o){var a=this,i=t.BASE_URL;t.request({url:i+"index/pintuan/pintuaninfo",data:{id:e,goodstype:o},method:"POST",success:function(t){console.log(t.data),a.pintuaninfo=t.data.data,a.postage=t.data.data.set.postage,a.total=(1*parseFloat(t.data.data.price)+parseFloat(t.data.data.set.postage)).toFixed(2)},fail:function(t){console.log(t.data)}})},changeYhm:function(t){this.yhm=t.detail.value},yhmbtn:function(){var e=this;if(""==this.yhm)return t.showToast({title:"优惠码不能为空",icon:"none"}),!1;if(""!=this.sonid)return t.showToast({title:"优惠码仅能用于课程目录购买",icon:"none"}),!1;if(this.shopcarlist)return t.showToast({title:"优惠码仅能用于单个商品购买",icon:"none"}),!1;var o=t.BASE_URL;t.request({url:o+"index/agent/yhmjh",data:{yhm:this.yhm,goodstype:this.goodstype,goodsid:this.menuid?this.menuid:this.goodsinfo.id},method:"POST",success:function(o){if(0==o.data.code){var a=o.data.data.price;Number(a)>=Number(e.total)?(e.total=0,e.paytype="yhm"):e.total=(parseFloat(e.total)-parseFloat(a)).toFixed(2)}else t.showToast({title:o.data.msg,icon:"none"})},fail:function(t){console.log(t.data)}})},getvipinfo:function(e){var o=this,a=t.BASE_URL;t.request({url:a+"index/vip/viptimeinfo",data:{id:e},method:"POST",success:function(t){o.viptimeinfo=t.data.data,o.total=parseFloat(t.data.data.price)},fail:function(t){console.log(t.data)}})},getmallset:function(){var e=this,o=t.BASE_URL;t.request({url:o+"index/mall/set",method:"GET",success:function(t){e.postage=t.data.data.postage,e.total=(parseFloat(e.total)+parseFloat(e.postage)).toFixed(2)},fail:function(t){console.log(t.data)}})},pxcourseinfo:function(e){var o=this,a=t.BASE_URL;t.request({url:a+"index/pxb/coursedetail",data:{id:e},method:"POST",success:function(t){o.pxcourse=t.data.data,o.total=1*parseFloat(t.data.data.price)},fail:function(t){console.log(t.data)}})},changeName:function(t){this.shr_name=t.detail.value},changePhone:function(t){this.shr_phone=t.detail.value},changeRemarks:function(t){this.remarks=t.detail.value},getaddress:function(e){var o=this,a=t.BASE_URL,i=t.getStorageSync("userinfo"),s=i.uid;"mr"!=e?t.request({url:a+"index/user/get_address",data:{id:e},method:"POST",success:function(t){console.log(t.data),0==t.data.code?o.addressinfo=t.data.data:o.addressinfo=""},fail:function(t){console.log(t.data)}}):t.request({url:a+"index/user/get_mr_address",data:{uid:s},method:"POST",success:function(t){console.log(t.data),0==t.data.code?o.addressinfo=t.data.data:o.addressinfo=""},fail:function(t){console.log(t.data)}})},shopcardata:function(){var e=this,o=t.getStorageSync("shop_trolley");console.log(o),o.forEach((function(t){postDataDetail({id:t.id}).then((function(o){o.data.data.total=o.data.data.price*t.amount,o.data.data.amount=t.amount,e.carlistdata.push(o.data.data),e.carlistdataid+=t.id+",",e.total=parseFloat(o.data.data.total)+e.total}))})),this.total=(parseFloat(this.total)+parseFloat(this.postage)).toFixed(2)},navigate:function(e){"vip"==e?t.switchTab({url:"/pages/".concat(e,"/").concat(e)}):"shipping-address"==e?t.navigateTo({url:"/pages/".concat(e,"/").concat(e,"?orderpage=1")}):t.navigateTo({url:"/pages/".concat(e,"/").concat(e)})},radioChange:function(t){this.paytype=t.target.value,console.log(this.paytype);for(var e=0;e<this.items.length;e++)if(this.items[e].value===t.target.value){this.current=e;break}},pay:function(){var e=t.getStorageSync("userinfo"),o=t.BASE_URL;if(""==this.paytype)return t.showToast({title:"请选择支付方式",icon:"none"}),!1;var a={};if("chongzhi"==this.goodstype)a={uid:e.uid,pay_type:this.paytype,goodstype:this.goodstype,price:this.total};else if("vip"==this.goodstype)a={uid:e.uid,menuid:this.viptimeinfo.id,pay_type:this.paytype,goodstype:this.goodstype,price:this.total};else if("course"==this.goodstype)a={uid:e.uid,menuid:this.menuid,sonid:this.sonid,pay_type:this.paytype,goodstype:this.goodstype,price:this.total,yhm:this.yhm,media:this.courseinfo.media,order_type:this.action};else if("pxcourse"==this.goodstype){if(""==this.shr_name)return t.showToast({title:"请输入您的姓名",icon:"none"}),!1;if(""==this.shr_phone)return t.showToast({title:"请输入您的电话",icon:"none"}),!1;a={uid:e.uid,menuid:this.pxcourse.id,pay_type:this.paytype,goodstype:this.goodstype,price:this.total,shr_name:this.shr_name,shr_phone:this.shr_phone,order_type:this.action}}else if("mall"==this.goodstype){if(""==this.addressinfo)return t.showToast({title:"请选择或添加您的地址",icon:"none"}),!1;a=this.shopcarlist?{uid:e.uid,menuid:this.carlistdataid,pay_type:this.paytype,goodstype:this.goodstype,price:this.total,yhm:this.yhm,addressid:this.addressinfo.id,postage:this.postage,remarks:this.remarks,order_type:this.action}:{uid:e.uid,menuid:this.goodsinfo.id,pay_type:this.paytype,goodstype:this.goodstype,price:this.total,yhm:this.yhm,addressid:this.addressinfo.id,postage:this.postage,remarks:this.remarks,order_type:this.action}}if(0==this.total)t.request({url:o+"index/pay/order_make",data:a,method:"POST",success:function(e){console.log(e.data),0==e.data.code&&(t.showToast({title:"支付成功！"}),setTimeout((function(){t.switchTab({url:"../user/user"})}),1e3))},fail:function(t){console.log(t.data)}});else if("wxpay"==this.paytype)a.openid=e.userdata.openid,a.apptype="MP-WEIXIN",t.request({url:o+"index/pay/order_make",data:a,method:"POST",success:function(e){console.log(e.data);var o=e.data.data;t.requestPayment({provider:"wxpay",timeStamp:String(o.timeStamp),nonceStr:o.nonceStr,package:o.package,signType:o.signType,paySign:o.sign,success:function(e){console.log("success:"+JSON.stringify(e)),t.showToast({title:"支付成功！"}),setTimeout((function(){t.switchTab({url:"../user/user"})}),800)},fail:function(t){console.log("fail:"+JSON.stringify(t))}})},fail:function(t){console.log(t.data)}});else if("credit"==this.paytype){a.apptype="",a.credit=this.creditinfo.credit,a.order_type=this.action;var i=e.userdata.credit;Number(this.creditinfo.credit)>Number(i)?t.showToast({title:"积分不足！",icon:"none"}):t.request({url:o+"index/pay/order_make",data:a,method:"POST",success:function(e){console.log(e.data),0==e.data.code&&(t.showToast({title:"兑换成功！"}),setTimeout((function(){t.switchTab({url:"../user/user"})}),1e3))},fail:function(t){console.log(t.data)}})}else if("balance"==this.paytype){a.apptype="";var s=e.userdata.money;Number(this.total)>Number(s)?t.showToast({title:"余额不足,请充值！",icon:"none"}):t.request({url:o+"index/pay/order_make",data:a,method:"POST",success:function(e){console.log(e.data),0==e.data.code&&(t.showToast({title:"支付成功！"}),setTimeout((function(){t.switchTab({url:"../user/user"})}),1e3))},fail:function(t){console.log(t.data)}})}else this.paytype},getCourseInfo:function(e,o){var a=this,i=t.BASE_URL;t.request({url:i+"index/courses/courseinfo",data:{menuid:e,sonid:o},method:"POST",success:function(t){console.log(t.data),"0"==t.data.code&&(a.courseinfo=t.data.data,a.total=1*parseFloat(a.courseinfo.price))},fail:function(t){console.log(t.data)}})}}};e.default=i}).call(this,o("543d")["default"])},"8b4e":function(t,e,o){"use strict";var a;o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return s})),o.d(e,"a",(function(){return a}));var i=function(){var t=this,e=t.$createElement;t._self._c},s=[]},b5a8:function(t,e,o){"use strict";(function(t){o("d51a");a(o("66fd"));var e=a(o("4e8f"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},ce38:function(t,e,o){}},[["b5a8","common/runtime","common/vendor"]]]);