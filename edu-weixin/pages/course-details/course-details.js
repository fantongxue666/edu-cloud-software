(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/course-details/course-details"],{"090f":function(e,t,i){},"326f":function(e,t,i){"use strict";i.r(t);var n=i("7350"),o=i("cdfa");for(var a in o)"default"!==a&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("f778");var s,r=i("f0c5"),u=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"98e94fd6",null,!1,n["a"],s);t["default"]=u.exports},7350:function(e,t,i){"use strict";var n;i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return n}));var o=function(){var e=this,t=e.$createElement;e._self._c},a=[]},b840:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i("9fce"),o=i("f1e2"),a=function(){Promise.all([i.e("common/vendor"),i.e("components/gaoyia-parse/parse")]).then(function(){return resolve(i("0ace"))}.bind(null,i)).catch(i.oe)},s=e.getBackgroundAudioManager(),r={components:{uParse:a},data:function(){return{kechengList:["课程介绍","目录","评价"],btnnum:0,currentTime:"",coursemenus:[],menuinfo:[],teacher:[],courses:[],comment:[],HOST_URL:e.HOST_URL,videostate:"",durationTime:"",coursehour:0,audio_paused:!0,audio_progress:0,gaosi:!1,t1:"",t2:"",t3:"",videosrc:"",free_time:"",video_controls:!0,videofullscreen:!1,menuid:"",sonid:"",videoStudyTime:0,audioStudyTime:0,is_free:!1,son_is_pay:!1,uid:"",is_dingyue:!1,videoContext:{},creditinfo:{},action:"",seckillinfo:{},pintuaninfo:{}}},onShareAppMessage:function(t){var i=getCurrentPages(),n=i[0].$page.fullPath,o=(i[0].data.title,e.getStorageSync("userinfo"));e.getStorageSync("base_set");return""!=o.uid&&o.uid?(t.from,{title:this.menuinfo.menuname,path:"".concat(n,"?pid=").concat(o.uid),imageUrl:this.HOST_URL+this.menuinfo.thumb}):(e.navigateTo({url:"../login/login"}),{title:"请先登录后再分享给好友",path:""})},onReady:function(t){this.videoContext=e.createVideoContext("myVideo")},onLoad:function(t){var i=this;console.log(t),(0,o.checkUserinfo)();var a=e.getStorageSync("userinfo");this.uid=a.uid,this.menuid=t.menuid,t.action&&(this.action=t.action,"credit"==t.action?this.get_creditinfo(t.menuid,"course"):"seckill"==t.action?this.get_seckillinfo(t.menuid,"course"):"pintuan"==t.action&&this.get_pintuaninfo(t.menuid,"course")),(0,n.getCourseDetails)({menuid:t.menuid,uid:this.uid}).then((function(e){i.is_dingyue=1==e.data.data.is_dingyue,i.comment=e.data.data.comment,i.menuinfo=e.data.data.menuinfo,i.teacher=e.data.data.teacher,i.courses=e.data.data.courses,i.coursehour=i.courses.length,0!=i.menuinfo.price&&1!=i.menuinfo.is_pay||(i.is_free=!0)})),1==a.userdata.is_vip&&(this.is_free=!0)},onShow:function(){var t=this;(0,o.checkUserinfo)();var i=s;i.onTimeUpdate((function(n){t.durationTime=t.format(i.duration),t.currentTime=t.format(i.currentTime);var o=(i.currentTime/i.duration).toFixed(2);t.audio_progress=100*o,t.is_free||t.son_is_pay||i.currentTime>=t.free_time&&(i.pause(),t.currentTime="00:00",i.seek(0),t.audio_progress=0,e.showModal({title:"试听结束",content:"需要解锁该课程吗?",success:function(e){e.confirm?t.pay():e.cancel}}))})),i.onSeeked((function(e){t.currentTime=t.format(i.currentTime)})),i.onPlay((function(e){t.videoContext.pause(),t.audio_paused=!1,t.gaosi_ani(),t.gaosi=!0,t.countAtime()})),i.onPause((function(e){t.audio_paused=!0,clearInterval(t.t1),clearInterval(t.t3),t.gaosi=!1,t.saveAtime()})),i.onStop((function(e){t.audio_paused=!0,clearInterval(t.t1),clearInterval(t.t3),t.saveAtime()})),i.onEnded((function(e){clearInterval(t.t1),clearInterval(t.t3),t.audio_paused=!0,t.currentTime="00:00",i.seek(0),t.saveAtime()}))},onUnload:function(){clearInterval(this.t1),clearInterval(this.t2),clearInterval(this.t3),this.menuid="",this.sonid="",this.saveAtime(),this.saveVtime()},methods:{jsdetail:function(){e.navigateTo({url:"../tutor-introduced/tutor-introduced?tid="+this.teacher.id})},get_creditinfo:function(t,i){var n=this,o=e.BASE_URL;e.request({url:o+"index/credit/creditinfo",data:{id:t,goodstype:i},method:"POST",success:function(e){console.log(e.data),n.creditinfo=e.data.data},fail:function(e){console.log(e.data)}})},get_seckillinfo:function(t,i){var n=this,o=e.BASE_URL;e.request({url:o+"index/seckill/seckillinfo",data:{id:t,goodstype:i},method:"POST",success:function(e){console.log(e.data),n.seckillinfo=e.data.data},fail:function(e){console.log(e.data)}})},get_pintuaninfo:function(t,i){var n=this,o=e.BASE_URL;e.request({url:o+"index/pintuan/pintuaninfo",data:{id:t,goodstype:i},method:"POST",success:function(e){console.log(e.data),n.pintuaninfo=e.data.data},fail:function(e){console.log(e.data)}})},saveStudytime:function(t,i){var n=e.BASE_URL;e.request({url:n+"index/user/save_studytime",method:"POST",data:{uid:this.uid,media:i,studytime:t},success:function(e){console.log(e.data)},fail:function(e){console.log(e.data)}})},saveAtime:function(){var t=e.getStorageSync("atime"),i={};t?(i.atime=t.atime+this.audioStudyTime,i.nowtime=(new Date).getTime(),e.setStorageSync("atime",i),this.saveStudytime(i.atime,"audio")):(i.atime=this.audioStudyTime,i.nowtime=(new Date).getTime(),e.setStorageSync("atime",i),this.saveStudytime(i.atime,"audio"))},saveVtime:function(){var t=e.getStorageSync("vtime"),i={};t?(i.vtime=t.vtime+this.videoStudyTime,i.nowtime=(new Date).getTime(),e.setStorageSync("vtime",i),this.saveStudytime(i.vtime,"video")):(i.vtime=this.videoStudyTime,i.nowtime=(new Date).getTime(),e.setStorageSync("vtime",i),this.saveStudytime(i.vtime,"video"))},countVtime:function(){var e=this;this.t2=setInterval((function(){e.videoStudyTime++}),1e3)},countAtime:function(){var e=this;this.t3=setInterval((function(){e.audioStudyTime++}),1e3)},dingyue:function(){var t=this,i=e.BASE_URL;e.request({url:i+"index/courses/dingyue",method:"POST",data:{uid:this.uid,media:this.menuinfo.media,menuid:this.menuid,goodstype:"course"},success:function(e){console.log(e.data),t.is_dingyue=1==e.data.data},fail:function(e){console.log(e.data)}})},pay:function(){""==this.sonid?e.navigateTo({url:"/pages/confirm-order-form/confirm-order-form?menuid="+this.menuid+"&goodstype=course"}):e.navigateTo({url:"/pages/confirm-order-form/confirm-order-form?menuid="+this.menuid+"&sonid="+this.sonid+"&goodstype=course"})},pay1:function(){e.navigateTo({url:"/pages/confirm-order-form/confirm-order-form?menuid="+this.menuid+"&goodstype=course"})},exchange:function(){e.navigateTo({url:"/pages/confirm-order-form/confirm-order-form?menuid="+this.menuid+"&goodstype=course&action=credit"})},seckill:function(){e.navigateTo({url:"/pages/confirm-order-form/confirm-order-form?menuid="+this.menuid+"&goodstype=course&action=seckill"})},pintuan:function(){e.navigateTo({url:"/pages/confirm-order-form/confirm-order-form?menuid="+this.menuid+"&goodstype=course&action=pintuan"})},fullscreen:function(e){this.videofullscreen=e.detail.fullScreen},video_onplay:function(){this.countVtime();var e=s;e.pause()},video_onpause:function(){clearInterval(this.t2),this.saveVtime()},video_onend:function(){clearInterval(this.t2),this.saveVtime()},video_timeUpdate:function(t){var i=t.detail.currentTime;t.detail.duration;this.is_free&&this.son_is_pay||this.son_is_pay||i>=this.free_time&&(this.videofullscreen&&this.videoContext.exitFullScreen(),this.videoContext.pause(),e.showModal({title:"试看结束",content:"需要解锁该课程吗?",success:function(e){e.confirm?this.pay():e.cancel&&this.videoContext.seek(0)}}))},gaosi_ani:function(){1==this.gaosi&&(this.t1=setInterval((function(){this.gaosi=!1,0==this.gaosi&&(this.gaosi=!0)}),4e3))},progress_text:function(e){var t=s,i=e.detail.value;this.currentTime=this.format(i/100*t.duration)},progress_change:function(e){var t=s,i=e.detail.value;this.currentTime=this.format(i/100*t.duration),t.seek(i/100*t.duration)},change_slide:function(e){var t=s;1==e?t.seek(t.currentTime+15):t.seek(t.currentTime-15)},play:function(){var e=s;e.paused?e.play():e.pause()},muluchange:function(e){this.btnnum=e},videoErrorCallback:function(t){e.showModal({content:t.target.errMsg,showCancel:!1})},openvideo:function(t){this.sonid=t.id;var i=this.is_free||1==t.is_pay?1:0;if(this.is_free||1==t.is_pay)if(this.son_is_pay=!0,"video"===t.media)this.videostate="video",this.videosrc=t.src;else if("audio"===t.media){if(this.videostate="audio",t.src){this.gaosi=!0;var n=s;n.title=t.coursename,n.singer=this.teacher.imgname,n.coverImgUrl=this.HOST_URL+this.menuinfo.thumb,n.src=t.src}}else e.navigateTo({url:"/pages/tuwen/tuwen?twid="+t.id+"&is_free="+i});else if(this.son_is_pay=!1,1==t.is_sk)if(this.free_time=t.freesecond,"video"===t.media)this.videostate="video",this.videosrc=t.src;else if("audio"===t.media){if(this.videostate="audio",t.src){this.gaosi=!0;var o=s;o.title=t.coursename,o.singer=this.teacher.imgname,o.coverImgUrl=this.HOST_URL+this.menuinfo.thumb,o.src=t.src}}else e.navigateTo({url:"/pages/tuwen/tuwen?twid="+t.id+"&is_free="+i});else e.showModal({title:"提示",content:"要解锁单个课程吗?",success:function(e){e.confirm?this.pay():e.cancel&&console.log("用户点击取消")}})},format:function(e){return"0".repeat(2-String(Math.floor(e/60)).length)+Math.floor(e/60)+":"+"0".repeat(2-String(Math.floor(e%60)).length)+Math.floor(e%60)}}};t.default=r}).call(this,i("543d")["default"])},cdfa:function(e,t,i){"use strict";i.r(t);var n=i("b840"),o=i.n(n);for(var a in n)"default"!==a&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=o.a},d02b:function(e,t,i){"use strict";(function(e){i("d51a");n(i("66fd"));var t=n(i("326f"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("543d")["createPage"])},f778:function(e,t,i){"use strict";var n=i("090f"),o=i.n(n);o.a}},[["d02b","common/runtime","common/vendor"]]]);